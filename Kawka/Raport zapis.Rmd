---
title: "Raport_Czesc_1"
author: "Witold Trzeciakowski"
date: "6/1/2021"
output:
  html_document:
    theme: united
    highlight: tango

---
```{r setup, include=F}
knitr::opts_chunk$set(include = T)
```
<center>  ***ZAPYTANIE 1***  </center>
Chcemy wylowic najlepszego kawiarza na forum. Człowieka który ma jak najwięszy wkład w społeczność. W tym celu musimy ustalic jakies kryterium. mozemy to zrobic po wyniku,jednak ja zastosuje inne rozwiązanie.
Proponuje wprowadzić indeks popularności ( roboczo nazwany "cytowaniami"). Jest to system oceny twórców, na naszym forum który bierzę pod uwagę odwołania do naszego posta i postów innych. Dzięki temu dowiemy się czy na naszym forum są posty zachęcające do dyskusji.
```{r Zadanie 1, results='asis',include = TRUE, echo=F ,warning=FALSE,message=FALSE,error=FALSE}
library(knitr)
library(xtable)
library(kableExtra)
library(reactable)
source("Witold_Trzeciakowski_313419.R")
cytowania <- Cytowania(links=PostLinks,Posts=Posts)
cytowania <- select(cytowania, cytowania, Score, Title)
cytowania <- head(cytowania,10)
#cytowania %>% kable() %>% kableExtra::kable_styling(full_width = T, bootstrap_options = 'striped')

reactable(cytowania)

```
  Widzimy teraz jakie posty maja najwiekszy wklad w życie społeczności tego forum. Teraz znajdzmy osoby które maja największe indeksy 'Cytowań'
  ```{r Zadanie 2, include = TRUE, echo=F ,warning=FALSE,message=FALSE,error=FALSE}
  source("Witold_Trzeciakowski_313419.R")
a <- Kawiarze_cytowania(Users=Users,cytowania=cytowania)
a <- select(a,DisplayName,Location,OgolneCytowania,Wyniki)
a <- head(a,10)
a %>% kable() %>% kableExtra::kable_styling(full_width = T, bootstrap_options = 'striped')

```
Popatrzymy teraz na pare ciekawych wyników, okazuje sie że tablica top 10 użytkowników po cytowaniach jest bardzo podobna do tej po wynikach ( większość użykowników sie powtarza). Poniżej pokazana jest lista top 10 użtkowników z najlepszymi wynikami, posegregowana po cytowaniach.
```{r Zadanie 3, include = TRUE, echo=F ,warning=FALSE,message=FALSE,error=FALSE}
  source("Witold_Trzeciakowski_313419.R")
a <- Kawiarze_Score(Users=Users,cytowania=cytowania)
a <- select(a,DisplayName,Location,OgolneCytowania,Wyniki)
a <- head(a,10)
a <- arrange(a,desc(OgolneCytowania))
a %>% kable() %>% kableExtra::kable_styling(full_width = T, bootstrap_options = 'striped')
```
Na pierwszy rzut oka mogłoby się wydawać że wykres punktow powinien rosnąć liniowo razem z indeksem cytowań, jednak okazuje się że nie jest to prawda.  
```{r Zadanie 4, echo=F, error=FALSE, message=FALSE, warning=FALSE, include=TRUE}
  source("Witold_Trzeciakowski_313419.R")
a <- Kawiarze_cytowania(Users=Users,cytowania=cytowania)
a <- zmiana_daty(a=a) #zmieniamy daty na nam przyjazne
a <- select(a,OgolneCytowania,Wyniki)
plot(a$Wyniki,a$OgolneCytowania,xlab='Cytowania',ylab = 'Wyniki',main='Wykres dla najlepiej cytowanych' )
al = par("usr")
segments(al[1], al[3], al[2], al[4], col='blue')
```  
<br/> 
Popatrzmy jeszcze na te wykresy dla uzytkownikow z najwieksza suma wyników
<br/>
  ```{r Zadanie 5, include = TRUE, echo=FALSE ,warning=FALSE,message=FALSE,error=FALSE}
  source("Witold_Trzeciakowski_313419.R")
a <- Kawiarze_Score(Users=Users,cytowania=cytowania)
a <- zmiana_daty(a=a) #zmieniamy daty na nam przyjazne
a <- select(a,OgolneCytowania,Wyniki)
plot(a$Wyniki,a$OgolneCytowania,xlab='Cytowania',ylab = 'Wyniki',main='Wykres dla ludzi z najlepszymi wynikami' )
al = par("usr")
segments(al[1], al[3], al[2], al[4], col='blue')
```
<br/>
Jak widzimy wartosci te nie rosną liniowo. Okazuje sie zatem ze uzytkownicy ktorych posty sa najwazniejsze dla spoleczności wcale nie maja wysokich ocen. 
<br/>
  ***Kawowe pytanie 2*** 
<br/>
Teraz chcialem zbadać wykres cen kawy w zależności od aktywnosci na forum
<br/> 
  ```{r Zadanie 6, include = TRUE, echo=F ,warning=FALSE,message=FALSE,error=FALSE}
ts_plot(Ceny_Kawy,Xtitle='czas',Ytitle='Cena w dolarach za kilogram', title='Cena kawy w latach 2015-2021')
```
<br/>
Zobaczmy teraz wykres aktywnosci na forum. Zbadamy go na kilka sposobów, pierwszym który zaproponuje jest sprawdzenie dat publikowanych postów. No więc weźmy się za to.
<br/>
  ```{r Zadanie 7, include = TRUE, echo=F ,warning=FALSE,message=FALSE,error=FALSE}
daty<- Znajdowanie_wykresu_daty(Posts=Posts)
rysowanie_aktywnosc(daty)
```
<br/>
Zauwazylismy teraz z o dziwo ( kto by sie spodziewal) nie ma korelacji pomiedzy aktywnoscia na forum a cena kawy.Jednak latwo mozna zauwazyc ze forum najpewniej umiera. Ciekawi mnie teraz czy nasi kawowi guru tez sie wylaczyli z forum w ostatnim czasie.
<br/>
  ```{r Zadanie 8, include = TRUE, echo=F ,warning=FALSE,message=FALSE,error=FALSE}
a <- last_activity()
wykres_aktywnosc(a)
```
<br/>
widzimy teraz ze ludzie ktorzy sa czesto cytowani odeszli niedawno, sprawdzmy teraz calosc
<br/>
  ```{r Zadanie 9, include = TRUE, echo=F ,warning=FALSE,message=FALSE,error=FALSE}
wykres_odchodzenie_wszyscy(Users)
```
<br/>
zbadajmy jeszcze aktywnosc za pomoca komentarzy
<br/>
  ```{r Zadanie 10, include = TRUE, echo=F ,warning=FALSE,message=FALSE,error=FALSE}
wykres_komentarze_czas(Votes)
```
<br/>
dochodzimy wiec do wniosku ze spolecznosc naszych najbardziej zagorzalych kawoszy nie odchodzi z forum ostatnimi czasy, jednak srednio ainteresowanych uzytkownikow ubywa.
<br/>
  ```{r Zadanie 11, include = TRUE, echo=F ,warning=FALSE,message=FALSE,error=FALSE}
wykres_ubywania(Users)
```
<br/>
<center> ***PODSUMOWANIE*** </center>
Pokazałem czemu warto rozważyć kryterium inne od jedynie wyniku przy ocenie postów i ich twórców. Zobaczyliśmy również że nasi kawowi wyjadacze nie odeszli z forum. Potem porównaliśmy wyniki z giełdowymi cenami kawy. W ostatnich krokach zbadalismy spadek aktywnosci na forum i doszlismy do wniosku ze forum umiera. Zatem odpowiedz na nasze pytanie zadane na poczatku jest taka: Kawowi guru istnieją i są stałymi bywalcami naszego forum, jednak duza część ludzi odchodzi. Rownież wpływ tego forum na rzeczywistość jest znikomy ( przynajmniej w ujęciu finansowym)
